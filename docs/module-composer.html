<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>composer - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/FrankerFaceZ/api-router" >GitHub</a></h2><h3>Classes</h3><ul><li><a href="Router.html">Router</a><ul class='methods'><li data-type='method'><a href="Router.html#METHOD">METHOD</a></li><li data-type='method'><a href="Router.html#middleware">middleware</a></li><li data-type='method'><a href="Router.html#mount">mount</a></li><li data-type='method'><a href="Router.html#nest">nest</a></li><li data-type='method'><a href="Router.html#param">param</a></li><li data-type='method'><a href="Router.html#register">register</a></li><li data-type='method'><a href="Router.html#setDataExclusive">setDataExclusive</a></li><li data-type='method'><a href="Router.html#sortData">sortData</a></li><li data-type='method'><a href="Router.html#urlFor">urlFor</a></li><li data-type='method'><a href="Router.html#use">use</a></li><li data-type='method'><a href="Router.html#useData">useData</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-composer.html">composer</a><ul class='methods'><li data-type='method'><a href="module-composer.html#~compose">compose</a></li></ul></li><li><a href="module-mount.html">mount</a><ul class='methods'><li data-type='method'><a href="module-mount.html#~Mount">Mount</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">composer</h1>
    

    




<section>

<header>
    
        
            
        
    
</header>

<article>
    
        <div class="container-overview">
        
            
                <div class="description"><p>An efficient middleware composer for Koa.</p></div>
            

            
                




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="composer.js.html">composer.js</a>, <a href="composer.js.html#line2">line 2</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





























            
        
        </div>
    

    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="~compose"><span class="type-signature">(inner) </span>compose<span class="signature">(input)</span><span class="type-signature"> &rarr; {function}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="composer.js.html">composer.js</a>, <a href="composer.js.html#line9">line 9</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Compose a method that will efficiently execute multiple middleware for
Koa. This makes use of the <a href="https://www.npmjs.com/package/reusify">reusify</a>
module to avoid allocating excess objects and functions during runtime when
at all possible. As a result, memory churn should be reduced while V8 should
be able to properly optimize these methods.</p>
<p>This can be used as a drop-in replacement for <a href="https://github.com/koajs/compose">koa-compose</a>.</p>
<p>Objects can be supplied, describing middleware that should be filtered to only
run on specific paths. These objects should be structured as:</p>
<pre class="prettyprint source lang-javascript"><code>{
    &quot;filtered&quot;: true,
    &quot;rich&quot;: true,
    &quot;test&quot;: /\/[a-z]{3}\//,
    &quot;fn&quot;: MiddlewareFunction
}</code></pre><p>If <code>rich</code> is true, <code>test</code> should be a compiled regular expression or some other
object that has a <code>.test(url)</code> method. If <code>rich</code> is false, <code>test</code> should be
a string to be compared via <code>url.startsWith(test)</code>.</p>
</div>









    <h5>Example</h5>
    
    <pre class="prettyprint"><code>app.use(compose(cors(), cache(), router.middleware()));</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>input</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>
|

<span class="param-type">Object</span>
|

<span class="param-type">Array.&lt;function()></span>
|

<span class="param-type">Array.&lt;Object></span>


            
            </td>

            

            

            <td class="description last"><p>The various middleware
to compose together. This can consist of functions or arrays of functions. The
input may also be comprised of objects that describe middleware that should
be filtered to only run on specific paths.</p></td>
        </tr>

    
    </tbody>
</table>














<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The composed middleware</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">function</span>


    </dd>
</dl>

    


        
    

    

    
</article>

</section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Aug 20 2018 20:21:30 GMT-0400 (Eastern Daylight Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>


</body>
</html>