<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Router - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/FrankerFaceZ/api-router" >GitHub</a></h2><h3>Classes</h3><ul><li><a href="Router.html">Router</a><ul class='methods'><li data-type='method'><a href="Router.html#defaultData">defaultData</a></li><li data-type='method'><a href="Router.html#METHOD">METHOD</a></li><li data-type='method'><a href="Router.html#middleware">middleware</a></li><li data-type='method'><a href="Router.html#mount">mount</a></li><li data-type='method'><a href="Router.html#nest">nest</a></li><li data-type='method'><a href="Router.html#param">param</a></li><li data-type='method'><a href="Router.html#register">register</a></li><li data-type='method'><a href="Router.html#setDataExclusive">setDataExclusive</a></li><li data-type='method'><a href="Router.html#sortData">sortData</a></li><li data-type='method'><a href="Router.html#urlFor">urlFor</a></li><li data-type='method'><a href="Router.html#use">use</a></li><li data-type='method'><a href="Router.html#useData">useData</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-composer.html">composer</a><ul class='methods'><li data-type='method'><a href="module-composer.html#~compose">compose</a></li></ul></li><li><a href="module-mount.html">mount</a><ul class='methods'><li data-type='method'><a href="module-mount.html#~Mount">Mount</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">Router</h1>
    

    




<section>

<header>
    
        <h2>
        Router
        </h2>
        
    
</header>

<article>
    
        <div class="container-overview">
        
            

    

    <h4 class="name" id="Router"><span class="type-signature"></span>new Router<span class="signature">(opts<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line39">line 39</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Create a new Router.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>opts</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Options for initializing this Router and the internal find-my-way router.</p>
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>host</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>An optional host for this router. Used when generating URLs. Can include variables, though that's slower and not recommended.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>An optional name for this router. Used when resolving a route for URL generation.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>prefix</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>An optional prefix to apply to all routes for this Router.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>findMyWay</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Options to provide to the internal find-my-way router.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>paramwareBeforeDataware</code></td>
            

            <td class="type">
            
                
<span class="param-type">Boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    <code>false</code>
                
                </td>
            

            <td class="description last"><p>If this is true, middleware registered for specific params will run before data-based middleware.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>mountMiddleware</code></td>
            

            <td class="type">
            
                
<span class="param-type">Boolean</span>
|

<span class="param-type"><a href="Router.html#~dataMiddleware">Router~dataMiddleware</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Middleware to use for <a href="Router.html#mount"><code>Router#mount</code></a> instead of <code>Mount</code>. If set to false, this will disable the automatic <code>mount</code> data-based middleware. As a result, <a href="Router.html#mount"><code>Router#mount</code></a> will not function correctly.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>handleOptions</code></td>
            

            <td class="type">
            
                
<span class="param-type">Boolean</span>
|

<span class="param-type"><a href="Router.html#~handleOptions">Router~handleOptions</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Whether or not to handle OPTIONS requests. Optionally takes a function to handle OPTIONS.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>handle405</code></td>
            

            <td class="type">
            
                
<span class="param-type">Boolean</span>
|

<span class="param-type"><a href="Router.html#~handleOptions">Router~handleOptions</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Whether or not to generate 405 responses when there are no matching methods for a route. Optionally takes a function to handle 405s.</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>



















        
        </div>
    

    

    

    
    
    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="defaultData"><span class="type-signature"></span>defaultData<span class="signature">(key, value)</span><span class="type-signature"> &rarr; {<a href="Router.html">Router</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line997">line 997</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>This allows you to set default data which is used for all routes that do not
have existing data set for a specific data-based middleware.</p>
</div>









    <h5>Example</h5>
    
    <pre class="prettyprint"><code>// For an example of how to write a simple cache dataware,
// check out the project README.
router.useData('cache', duration => {
    // duration is the number of seconds
    // &lt;cache logic goes here>
    return cache_middleware;
});

// We default to a 60 second cache.
router.defaultData('cache', 60);

router.get('/', ctx => {
    ctx.body = 'This uses the default cache of 60 seconds: ' + Date.now();
});

router.get('/fast', {cache: 5}, ctx => {
    ctx.body = 'This is only cached for 5 seconds: ' + Date.now();
});</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>key</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last"><p>The data key</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>value</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p>The default value to set. <code>undefined</code> to remove.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The Router</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Router.html">Router</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="METHOD"><span class="type-signature"></span>METHOD<span class="signature">(name<span class="signature-attributes">opt</span>, path, options<span class="signature-attributes">opt</span>, &hellip;middleware)</span><span class="type-signature"> &rarr; {<a href="Router.html">Router</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line755">line 755</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Match URL paths to middleware using <code>router.METHOD()</code> where <code>method</code> is an HTTP method,
such as GET, POST, or DELETE. The special method <code>router.all()</code> will match all methods.</p>
<p>When a route is matched, the route's options will be available at <code>ctx.state.route</code>.</p>
<p>Route paths are passed directly to an internal <a href="https://www.npmjs.com/package/find-my-way">find-my-way</a>
instance and should be written using that syntax. This syntax, for the most part,
mirrors that used by <a href="https://github.com/pillarjs/path-to-regexp">path-to-regexp</a>.</p>
<p>If supplied, hosts are parsed with <code>path-to-regexp</code>. Hosts without variables are checked
with simple string comparison while hosts with variables are matched with a regular
expression generated by <code>path-to-regexp</code>.</p>
<p>Any variables within the host will be stored in <code>ctx.host_params</code> and <code>ctx.request.host_params</code>.</p>
</div>









    <h5>Example</h5>
    
    <pre class="prettyprint"><code>router
    .get('/', (ctx, next) => {
        ctx.body = "Hello, World!"
    })
    .post('user', '/user/:userID', (ctx, next) => {
        // ...
    })
    .del('/topic/:topicID/message/:messageID', {some_data: false}, (ctx, next) => {
        // ...
    })</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>A name for this route. Equivilent to setting a name key in options.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>path</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Array.&lt;String></span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>A path or multiple paths that these middleware functions will match.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional data to associate with the route, including a name and data for data-based middleware.</p>
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>host</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional host for this specific route. Different methods on the same route must use the same host.</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>middleware</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                    &lt;repeatable><br>
                
                </td>
            

            

            <td class="description last"><p>Middleware functions to handle this route.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The router</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Router.html">Router</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="middleware"><span class="type-signature"></span>middleware<span class="signature">()</span><span class="type-signature"> &rarr; {function}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line167">line 167</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Get a middleware method for adding a <a href="Router.html"><code>Router</code></a> to Koa.</p>
</div>









    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const router = Router();
app.use(router.middleware())</code></pre>


















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Koa Middleware</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">function</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="mount"><span class="type-signature"></span>mount<span class="signature">(path, options<span class="signature-attributes">opt</span>, &hellip;middleware)</span><span class="type-signature"> &rarr; {<a href="Router.html">Router</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line1108">line 1108</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Mount the given middleware at a specific path. This will register the
middleware for all HTTP methods on the given route, and strip the path
from <code>ctx.path</code> temporarilly when calling the middleware.</p>
<p>Internally, this acts by setting the option <code>{mount: '*'}</code> on the generated
route while also ensuring the path ends with <code>/*</code>. This method will not
function correctly if the built-in mount middleware is disabled.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>path</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Array.&lt;String></span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>The path to mount the middleware at.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>An optional set of options for the middleware.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>middleware</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                    &lt;repeatable><br>
                
                </td>
            

            

            <td class="description last"><p>The middleware function(s) to use</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The Router</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Router.html">Router</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="nest"><span class="type-signature"></span>nest<span class="signature">(path<span class="signature-attributes">opt</span>, router)</span><span class="type-signature"> &rarr; {<a href="Router.html">Router</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line1163">line 1163</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Nest another <a href="Router.html"><code>Router</code></a> as a child of this router, inheriting all of
its routes, middleware, etc.</p>
</div>









    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const users = Router({prefix: '/user'});

users.get('/:userID', ctx => {
    // ...
});

router.nest(users);</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>path</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Array.&lt;String></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>The path to nest the router at.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>router</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Router.html">Router</a></span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>The router instance to be nested.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The Router</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Router.html">Router</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="param"><span class="type-signature"></span>param<span class="signature">(param, &hellip;middleware)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line1079">line 1079</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Use middleware for a named route parameter. This is useful for
automatically loading data or performing validation for commonly used
route parameters.</p>
</div>









    <h5>Example</h5>
    
    <pre class="prettyprint"><code>router.param('userID', async (userID, ctx, next) => {
    ctx.user = await Users.query().where('id', userID);
    return next();
});

router.get('/user/:userID', ctx => {
    // ... do something with ctx.user
});</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>param</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>The name of the parameter to handle.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>middleware</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                    &lt;repeatable><br>
                
                </td>
            

            

            <td class="description last"><p>The middleware to apply to that parameter.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="register"><span class="type-signature"></span>register<span class="signature">(methods, path, options, &hellip;middleware)</span><span class="type-signature"> &rarr; {<a href="Router.html">Router</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line808">line 808</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Register a new route and update the router's internal state.</p>
</div>









    <h5>Example</h5>
    
    <pre class="prettyprint"><code>router.register('get', '/', null, ctx => {
    ctx.body = "Hello, World!"
})</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>methods</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Array.&lt;String></span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>The HTTP methods that these middleware functions can handle.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>path</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Array.&lt;String></span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>A path or multiple paths that these middleware functions will match.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>
|

<span class="param-type">null</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional data to associate with the route, including a name and data for data-based middleware.</p>
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>host</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional host for this specific route. Different methods on the same route must use the same host.</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>middleware</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                    &lt;repeatable><br>
                
                </td>
            

            

            <td class="description last"><p>Middleware functions to handle this route.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The Router</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Router.html">Router</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="setDataExclusive"><span class="type-signature"></span>setDataExclusive<span class="signature">(key, exclusive<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="Router.html">Router</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line1045">line 1045</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>This method allows you to mark a specific key for data-based middleware as
exclusive. This will prevent a parent's data-based middleware from being
applied to the routes of a nested <a href="Router.html"><code>Router</code></a>.</p>
<p>The default <code>mount</code> middleware is set to exclusive to prevent multiple copies
of the mount middleware being applied to matching routes.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>key</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>The data key</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>exclusive</code></td>
            

            <td class="type">
            
                
<span class="param-type">Boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    <code>true</code>
                
                </td>
            

            <td class="description last"><p>Whether or not data-based middleware for
the provided key should be exclusive.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The Router</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Router.html">Router</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="sortData"><span class="type-signature"></span>sortData<span class="signature">(key, sort_value<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="Router.html">Router</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line1021">line 1021</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>This allows you to override the order in which data-based middleware are
applied. You can also provide this value when defining your data-based
middleware constructors with <a href="Router.html#useData"><code>Router#useData</code></a>.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>key</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>The data key</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>sort_value</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    <code>0</code>
                
                </td>
            

            <td class="description last"><p>A number to use for this data-based
middleware when sorting to determine which to apply first. Lower values
execute first.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The Router</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Router.html">Router</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="urlFor"><span class="type-signature"></span>urlFor<span class="signature">(name, params<span class="signature-attributes">opt</span>, options<span class="signature-attributes">opt</span>, source_host<span class="signature-attributes">opt</span>, source_protocol<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {String}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line1249">line 1249</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Generate a URL for the route with the given name.</p>
<p>Routes will inherit the name of the <a href="Router.html"><code>Router</code></a> that contains them. As
a shortcut for accessing other routes in the same namespace, you can start
the name passed to <code>urlFor</code> with a period.</p>
<p><code>urlFor</code> is assigned to the current Koa context and should be used there
to ensure namespaces work correctly.</p>
<p>Once the URL has been built (using
<a href="https://github.com/pillarjs/path-to-regexp">path-to-regexp</a>) that generated
URL and any left over parameters are merged into <code>options</code> and the structure
is passed to <a href="https://nodejs.org/api/url.html#url_url_format_urlobject">url.format()</a></p>
<p>If the Router or specific route is using a host, and a host hasn't been specified
in options, the host will be checked against <code>source_host</code>. If the host does not
match, an absolute URL will be generated.</p>
<p>Any host variables for the route must be included in <code>params</code>.</p>
</div>









    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const router = Router(),
      user_router = Router({name: 'user', prefix: '/user'});

user_router.get('me', '/me', ctx => {
    ctx.redirect(ctx.urlFor('.id', ctx.state.current_user.id));
});

user_router.get('id', '/:userID', ctx => {
    // ...
});

router.use(user_router);

router.get('/', ctx => {
    ctx.redirect(ctx.urlFor('user.me'));
});</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>The name of the route</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Parameters to place in the generated URL.
Required if the route takes parameters. Any parameter not consumed in the route
will be added as a query parameter.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Options to pass to <code>url.format()</code>.</p>
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>query</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Query parameters for the generated URL.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>absolute</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    <code>false</code>
                
                </td>
            

            <td class="description last"><p>If set to true, the generated URL will always be absolute.</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    

        <tr>
            
                <td class="name"><code>source_host</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>The host from the request that triggered this method.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>source_protocol</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>The protocol from the request that triggered this method.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The generated URL.</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">String</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="use"><span class="type-signature"></span>use<span class="signature">(path<span class="signature-attributes">opt</span>, &hellip;middleware)</span><span class="type-signature"> &rarr; {<a href="Router.html">Router</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line858">line 858</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Use the given middleware. Middleware are run in the order they are defined.
This can also be used to nest another <a href="Router.html"><code>Router</code></a> as a child of this
router.</p>
</div>









    <h5>Example</h5>
    
    <pre class="prettyprint"><code>router.use(SomeMiddleware);
router.use('/user', SomeUserMiddleware);
router.use(anotherRouter);</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>path</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>
|

<span class="param-type">Array.&lt;String></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>A path or array of paths to limit the middleware to</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>middleware</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>
|

<span class="param-type"><a href="Router.html">Router</a></span>


            
            </td>

            
                <td class="attributes">
                

                

                
                    &lt;repeatable><br>
                
                </td>
            

            

            <td class="description last"><p>The middleware function(s) to use</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The Router</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Router.html">Router</a></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="useData"><span class="type-signature"></span>useData<span class="signature">(key, sort_value<span class="signature-attributes">opt</span>, &hellip;constructor)</span><span class="type-signature"> &rarr; {<a href="Router.html">Router</a>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line945">line 945</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>Use constructed middleware on routes with the provided data key. Constructors
registered using this method are executed when pre-calculating a route's middleware
chain. The constructors are expected to return a middleware function or array of
functions. These functions will be run after general middleware registered
via <a href="Router.html#use"><code>Router#use</code></a> but before the middleware functions registered for a route.</p>
<p>By setting a <code>sort</code> property on the returned middleware method, it is possible
to override the sorting for that specific method.</p>
</div>









    <h5>Example</h5>
    
    <pre class="prettyprint"><code>router.useData('headers', headers => {
    return async (ctx, next) => {
        await next();
        ctx.set(headers);
    }
});

router.useData('validation', -1, options => {
    const postFn = (ctx, next) => {
        // This runs after headers
        await next();
    };

    // Make postFn run later
    postFn.sort = 2;

    return [
        async (ctx, next) => {
            // This runs before headers
            await next();
        },
        postFn
    ];
});

router.get('/', {
    headers: {
        'Access-Control-Allow-Origin': '*'
    },
    validation: true
}, ctx => {
    ctx.body = "Hello, World!";
});</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>key</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>The data key to match</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>sort_value</code></td>
            

            <td class="type">
            
                
<span class="param-type">Number</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    <code>0</code>
                
                </td>
            

            <td class="description last"><p>A number to use for this data-based middleware when
sorting to determine which to apply first. Lower values execute first.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>constructor</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                    &lt;repeatable><br>
                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>The middleware constructor function(s) to use</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The Router</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Router.html">Router</a></span>


    </dd>
</dl>

    



        
    

    
        <h3 class="subsection-title">Type Definitions</h3>

        
                

    

    <h4 class="name" id="~dataMiddleware"><span class="type-signature"></span>dataMiddleware<span class="signature">(data, route, _store)</span><span class="type-signature"> &rarr; {function|Array.&lt;function()>}</span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line105">line 105</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>A factory for Koa middleware, acting off of data attached to a specific route.
The returned function or functions may have a <code>sort</code> property for overriding the
sorting of that specific middleware instance on that specific route.</p>
</div>









    <h5>Example</h5>
    
    <pre class="prettyprint"><code>router.useData('database', options => {
    const connection = database.getConnection(options);

    return async (ctx, next) => {
        const cursor = connection.getCursor();
        ctx.db = cursor;
        try {
            await next();
        } finally {
            cursor.close();
            ctx.db = null;
        }
    }
});

router.useData('validation', options => {
    const methods = [];

    if ( options.query )
        methods.push((ctx, next) => {
            validateQuery(options.query, ctx.query);
            return next();
        });

    if ( options.result ) {
        const fn = async (ctx, next) => {
            await next();
            validateResult(options.result, ctx);
        };

        fn.sort = 2;
        methods.push(fn);
    }

    return methods;
});</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>data</code></td>
            

            <td class="type">
            
                
<span class="param-type">*</span>


            
            </td>

            

            

            <td class="description last"><p>The data attached to a route that triggered the instantiation of this
data-ware middleware.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>route</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last"><p>The applicable route</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>_store</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p>The internal data store for the route.</p></td>
        </tr>

    
    </tbody>
</table>
















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Koa Middleware</p>
</div>



<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">function</span>
|

<span class="param-type">Array.&lt;function()></span>


    </dd>
</dl>

    



            
                

    

    <h4 class="name" id="~handleOptions"><span class="type-signature"></span>handleOptions<span class="signature">(ctx, next, store)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="router.js.html">router.js</a>, <a href="router.js.html#line84">line 84</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description">
    <p>A Koa middleware function that has an additional parameter containing the internal
route data, called when a route is matched but the requested method has no handler.</p>
<p>These functions are used for generating <code>405 Method Not Allowed</code> responses, as well
as responses to <code>OPTIONS</code> requests.</p>
</div>









    <h5>Example</h5>
    
    <pre class="prettyprint"><code>const router = Router({
    handleOptions: (ctx, next, store) => {
        ctx.set('Allow', Object.keys(store).join(', ').toUpperCase());
        ctx.status = 204;
    }
})</code></pre>




    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ctx</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p>The Koa Context</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>next</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>The next middleware in the stack</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>store</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p>The internal route object, with keys for each handled method</p></td>
        </tr>

    
    </tbody>
</table>



















            
    

    
</article>

</section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Wed Feb 12 2020 02:39:17 GMT-0500 (Eastern Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>